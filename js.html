<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">

<meta http-equiv="Content-Security-Policy" content="
default-src 'self';
script-src 'self';
style-src 'self' 'unsafe-inline';
img-src 'self';
frame-ancestors 'none';
object-src 'none';
base-uri 'none';
">

<meta name="referrer" content="no-referrer">

<title>Auditoria de Segurança – Página Estática</title>

<style>
:root {
  --ok:#2ecc71;
  --warn:#f1c40f;
  --bad:#e74c3c;
  --bg:#0c0f14;
  --card:#151a22;
}

body {
  margin:0;
  background:var(--bg);
  color:#e6e6e6;
  font-family:system-ui, sans-serif;
}

.container {
  max-width:900px;
  margin:auto;
  padding:24px;
}

h1 {
  margin-bottom:8px;
}

.grid {
  display:grid;
  grid-template-columns:repeat(auto-fit,minmax(260px,1fr));
  gap:16px;
}

.card {
  background:var(--card);
  border-radius:12px;
  padding:16px;
}

.status {
  font-weight:700;
}

.ok { color:var(--ok); }
.warn { color:var(--warn); }
.bad { color:var(--bad); }

small {
  opacity:.7;
}
</style>
</head>

<body>
<div class="container">
<h1>Auditoria de Segurança</h1>
<p>Detecção real no navegador. Sem simulação.</p>

<div class="grid" id="results"></div>
</div>

<script>
'use strict';

const results = [];

function add(title, status, detail) {
  results.push({ title, status, detail });
}

/* CSP */
const csp = document.querySelector('meta[http-equiv="Content-Security-Policy"]');
add(
  'Content Security Policy',
  csp ? 'ok' : 'bad',
  csp ? 'CSP presente' : 'CSP ausente'
);

/* Iframe */
add(
  'Proteção contra iframe',
  window.top === window.self ? 'ok' : 'bad',
  window.top === window.self ? 'Não está embutida' : 'Página rodando em iframe'
);

/* Scripts externos */
const externos = [...document.scripts].filter(s => s.src && !s.src.startsWith(location.origin));
add(
  'Scripts externos',
  externos.length === 0 ? 'ok' : 'bad',
  externos.length === 0 ? 'Nenhum detectado' : `${externos.length} script(s) externo(s)`
);

/* APIs de rede */
add(
  'APIs de rede',
  (window.fetch || window.XMLHttpRequest) ? 'warn' : 'ok',
  (window.fetch || window.XMLHttpRequest)
    ? 'APIs disponíveis'
    : 'APIs indisponíveis'
);

/* Storage */
add(
  'Storage',
  (localStorage || sessionStorage) ? 'warn' : 'ok',
  'Storage acessível ao JS'
);

/* Render */
const grid = document.getElementById('results');
results.forEach(r => {
  const div = document.createElement('div');
  div.className = 'card';
  div.innerHTML = `
    <h3>${r.title}</h3>
    <p class="status ${r.status}">${r.status.toUpperCase()}</p>
    <small>${r.detail}</small>
  `;
  grid.appendChild(div);
});
</script>
</body>
</html>
